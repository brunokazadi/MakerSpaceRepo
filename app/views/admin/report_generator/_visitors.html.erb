<% provide(:title, 'Reports') %>

<section>
  <h1 class="text-center py-4 fw-bold">
    New Visitors <%= link_to fa_icon('download'),
                             admin_report_generator_generate_spreadsheet_path(start_date: params[:start_date], end_date: params[:end_date], type: 'visitors'),
                             class: 'border-0 bg-transparent text-primary' %>
  </h1>

  <% if @lab_sessions.empty? %>
    <div class="text-center">No lab sessions to display</div>
  <% else %>
    <div class="mb-5 text-center">
      <% if @date_specified %>
        Displaying <%= @lab_sessions.count %> <%= 'lab session'.pluralize(@lab_sessions.count) %> from <b><%= params[:start_date][0..9] %> to <%= params[:end_date][0..9] %></b>
      <% else %>
        Displaying <b>all</b> <%= @lab_sessions.count %> <%= 'lab session'.pluralize(@lab_sessions.count) %>
      <% end %>
    </div>

    <%= render partial: 'line_chart', locals: { data: @lab_sessions, model: 'Lab Sessions' } %>

    <div class="mb-5">
      <h4 class="text-center">Unique Visitors per Space</h4>
      <%= column_chart @space_unique_count, label: 'Unique Visitors' %>
    </div>

    <div class="mb-5">
      <h4 class="text-center">Total Visits per Space</h4>
      <%= column_chart @space_total_count, label: 'Total Visits' %>
    </div>

    <div class="d-flex flex-row flex-wrap mb-5">
      <div class="w-50">
        <h4 class="text-center">Unique Visitors by Identity</h4>
        <%= pie_chart @identity_unique_count %>
      </div>
      <div class="w-50">
        <h4 class="text-center">Total Visits by Identity</h4>
        <%= pie_chart @identity_total_count %>
      </div>
      <div class="w-50">
        <h4 class="text-center">Unique Visitors by Faculty</h4>
        <%= pie_chart @faculty_unique_count.slice('Arts', 'Civil Law', 'Common Law', 'Education', 'Engineering', 'Health Sciences', 'Medicine', 'Science', 'Social Sciences', 'Telfer School of Management') %>
      </div>
      <div class="w-50">
        <h4 class="text-center">Total Visits by Faculty</h4>
        <%= pie_chart @faculty_total_count.slice('Arts', 'Civil Law', 'Common Law', 'Education', 'Engineering', 'Health Sciences', 'Medicine', 'Science', 'Social Sciences', 'Telfer School of Management') %>
      </div>
    </div>
  <% end %>
</section>